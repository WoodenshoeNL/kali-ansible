
- name: EntraFalcon - clone repository
  ansible.builtin.git:
    repo: https://github.com/CompassSecurity/EntraFalcon
    dest: "{{ login_home }}/entrafalcon"            # fixed path keeps things predictable
    version: main
    update: yes
    # force: yes           # uncomment if {{ login_home }}/blackcat already exists but isnâ€™t a repo
  become: yes
  become_user: "{{ login_user }}"
  tags:
    - entrafalcon
    - cloud

- name: EntraFalcon - add quick reminder read-me
  ansible.builtin.copy:
    dest: "{{ login_home }}/README_entrafalcon_RUN.txt"
    mode: "0644"
    content: |
      HOW TO RUN

      pwsh
      PS> cd EntraFalcon
      PS> .\run_EntraFalcon.ps1 -AuthMethod "DeviceCode"
  become: yes
  become_user: "{{ login_user }}"
  tags:
    - entrafalcon
    - cloud